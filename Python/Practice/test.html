{
  "query": {
    "bool" : {
      "must" : {
        "term" : { "user" : "kimchy" }
      },
      "filter": {
        "term" : { "tag" : "tech" }
      },
      "must_not" : {
        "range" : {
          "age" : { "gte" : 10, "lte" : 20 }
        }
      },
      "should" : [
        { "term" : { "tag" : "wow" } },
        { "term" : { "tag" : "elasticsearch" } }
      ],
      "minimum_should_match" : 1,
      "boost" : 1.0
    }
  }
}


{
  "query": {
          "bool": {
      "must":
        {
        "range" : {
            "order_datetime" : {
                "gte" : "2019-09-01T00:00:00.000Z",
                "lt" :  "2019-09-13T00:00:00.000Z"
            }
        }
        },
      "must_not": [
                  {"term": {"order_status": "Auto-Reversed"}},
                  {"term": {"order_status": "Successful"}}
                ]
    }
    },
  "size": 0,
  "aggs": {
    "group_by_reg_id": {
      "terms": {
        "field": "reg_id",
        "size" : 10000,
        "order": {"quantity_sum": "desc"}
      },
      "aggs": {
    "quantity_sum":{
      "sum": {
        "field": "order_gross_amt"
      }
    }
  }
    }
  }
}
